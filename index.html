<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Game | SnowMan YT</title>

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#050b1a;
  font-family:system-ui;
}
canvas{
  display:block;
}
#footer{
  position:fixed;
  bottom:10px;
  width:100%;
  text-align:center;
  color:#aaa;
  font-size:13px;
}
#ui{
  position:fixed;
  top:15px;
  right:15px;
  color:white;
  font-size:14px;
}
button{
  background:#00ffd5;
  border:none;
  padding:6px 12px;
  border-radius:20px;
  cursor:pointer;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div id="ui">
  <button onclick="toggleSound()">ðŸ”Š Sound</button>
</div>

<div id="footer">Game developed by @ SnowMan YT</div>

<audio id="bgm" loop>
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_2e4a89d5c3.mp3">
</audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
resize();
window.addEventListener("resize", resize);

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}

const CELL = 14;
let snake = [];
let dir = {x:1,y:0};
let speed = 2.5;
let food = {};
let bossFood = null;
let foodCount = 0;
let bossTimer = 0;
let soundOn = true;

const bgm = document.getElementById("bgm");
bgm.volume = 0.4;
bgm.play();

function toggleSound(){
  soundOn = !soundOn;
  soundOn ? bgm.play() : bgm.pause();
}

// INIT SNAKE
for(let i=0;i<20;i++){
  snake.push({x:canvas.width/2 - i*CELL,y:canvas.height/2});
}

spawnFood();

function spawnFood(){
  food = {
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height
  };
}

function spawnBossFood(){
  bossFood = {
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height
  };
  bossTimer = 300;
}

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp") dir={x:0,y:-1};
  if(e.key==="ArrowDown") dir={x:0,y:1};
  if(e.key==="ArrowLeft") dir={x:-1,y:0};
  if(e.key==="ArrowRight") dir={x:1,y:0};
});

let touchStart=null;
canvas.addEventListener("touchstart",e=>{
  touchStart=e.touches[0];
});
canvas.addEventListener("touchend",e=>{
  const t=e.changedTouches[0];
  const dx=t.clientX-touchStart.clientX;
  const dy=t.clientY-touchStart.clientY;
  if(Math.abs(dx)>Math.abs(dy)){
    dir=dx>0?{x:1,y:0}:{x:-1,y:0};
  }else{
    dir=dy>0?{x:0,y:1}:{x:0,y:-1};
  }
});

function update(){
  const head = {...snake[0]};
  head.x += dir.x * speed;
  head.y += dir.y * speed;

  // WRAP SCREEN
  if(head.x<0) head.x=canvas.width;
  if(head.y<0) head.y=canvas.height;
  if(head.x>canvas.width) head.x=0;
  if(head.y>canvas.height) head.y=0;

  snake.unshift(head);
  snake.pop();

  // FOOD COLLISION
  if(Math.hypot(head.x-food.x, head.y-food.y)<20){
    snake.push({...snake[snake.length-1]});
    spawnFood();
    foodCount++;
    if(foodCount%5===0) spawnBossFood();
  }

  // BOSS FOOD
  if(bossFood){
    bossTimer--;
    if(Math.hypot(head.x-bossFood.x, head.y-bossFood.y)<25){
      for(let i=0;i<5;i++) snake.push({...snake[snake.length-1]});
      bossFood=null;
    }
    if(bossTimer<=0) bossFood=null;
  }
}

function drawSnake(){
  ctx.lineJoin="round";
  ctx.lineCap="round";
  ctx.beginPath();
  ctx.moveTo(snake[0].x, snake[0].y);

  for(let i=1;i<snake.length;i++){
    const p=snake[i];
    ctx.lineTo(p.x,p.y);
  }

  const grad=ctx.createLinearGradient(
    snake[0].x,snake[0].y,
    snake[snake.length-1].x,snake[snake.length-1].y
  );
  grad.addColorStop(0,"#00ffd5");
  grad.addColorStop(1,"#0066ff");
  ctx.strokeStyle=grad;
  ctx.lineWidth=18;
  ctx.stroke();

  // HEAD
  const h=snake[0];
  ctx.beginPath();
  ctx.fillStyle="#00ffe1";
  ctx.arc(h.x,h.y,14,0,Math.PI*2);
  ctx.fill();

  // EYES
  const a=Math.atan2(dir.y,dir.x);
  for(let s of [-1,1]){
    ctx.beginPath();
    ctx.fillStyle="#fff";
    ctx.arc(
      h.x+Math.cos(a+0.4*s)*6,
      h.y+Math.sin(a+0.4*s)*6,
      3,0,Math.PI*2
    );
    ctx.fill();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // FOOD
  ctx.beginPath();
  ctx.fillStyle="#ff4757";
  ctx.shadowBlur=15;
  ctx.shadowColor="#ff4757";
  ctx.arc(food.x,food.y,8,0,Math.PI*2);
  ctx.fill();
  ctx.shadowBlur=0;

  // BOSS FOOD
  if(bossFood){
    ctx.beginPath();
    ctx.fillStyle="#ffd700";
    ctx.shadowBlur=20;
    ctx.shadowColor="#ffd700";
    ctx.arc(bossFood.x,bossFood.y,14,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="#fff";
    ctx.font="14px monospace";
    ctx.fillText(Math.ceil(bossTimer/60),bossFood.x-5,bossFood.y-20);
    ctx.shadowBlur=0;
  }

  drawSnake();
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>

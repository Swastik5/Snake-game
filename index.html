<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Game | SnowMan YT</title>

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#050b1a;
  font-family:system-ui;
}
canvas{display:block}
#footer{
  position:fixed;
  bottom:10px;
  width:100%;
  text-align:center;
  color:#aaa;
  font-size:13px;
}
#ui{
  position:fixed;
  top:15px;
  right:15px;
}
button{
  background:#00ffd5;
  border:none;
  padding:6px 14px;
  border-radius:20px;
  cursor:pointer;
  font-weight:600;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<div id="ui">
  <button onclick="toggleSound()">ðŸ”Š Sound</button>
</div>

<div id="footer">Game developed by @ SnowMan YT</div>

<!-- AUDIO -->
<audio id="bgm" loop src="https://cdn.pixabay.com/audio/2022/03/15/audio_2e4a89d5c3.mp3"></audio>
<audio id="eatSound" src="https://cdn.pixabay.com/audio/2022/03/10/audio_6f8c61d3f2.mp3"></audio>
<audio id="bossAppearSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_8d06b67fa4.mp3"></audio>
<audio id="bossEatSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_9c0cfe7d65.mp3"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
resize();
window.addEventListener("resize", resize);

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}

let snake=[], dir={x:1,y:0}, speed=2.6;
let food={}, bossFood=null, foodCount=0, bossTimer=0;
let soundOn=true;

const bgm=document.getElementById("bgm");
const eatSound=document.getElementById("eatSound");
const bossAppearSound=document.getElementById("bossAppearSound");
const bossEatSound=document.getElementById("bossEatSound");

bgm.volume=0.35;
eatSound.volume=bossAppearSound.volume=bossEatSound.volume=0.6;
bgm.play();

function toggleSound(){
  soundOn=!soundOn;
  soundOn?bgm.play():bgm.pause();
}
function playSFX(s){
  if(soundOn){
    s.currentTime=0;
    s.play();
  }
}

// INIT SNAKE
for(let i=0;i<20;i++)
  snake.push({x:innerWidth/2-i*16,y:innerHeight/2,wrap:false});

spawnFood();

function spawnFood(){
  food={x:Math.random()*canvas.width,y:Math.random()*canvas.height};
}
function spawnBossFood(){
  bossFood={x:Math.random()*canvas.width,y:Math.random()*canvas.height};
  bossTimer=300;
  playSFX(bossAppearSound);
}

// CONTROLS
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp")dir={x:0,y:-1};
  if(e.key==="ArrowDown")dir={x:0,y:1};
  if(e.key==="ArrowLeft")dir={x:-1,y:0};
  if(e.key==="ArrowRight")dir={x:1,y:0};
});

let touchStart=null;
canvas.addEventListener("touchstart",e=>touchStart=e.touches[0]);
canvas.addEventListener("touchend",e=>{
  const t=e.changedTouches[0];
  const dx=t.clientX-touchStart.clientX;
  const dy=t.clientY-touchStart.clientY;
  Math.abs(dx)>Math.abs(dy)
    ?dir=dx>0?{x:1,y:0}:{x:-1,y:0}
    :dir=dy>0?{x:0,y:1}:{x:0,y:-1};
});

function update(){
  const prev=snake[0];
  let x=prev.x+dir.x*speed;
  let y=prev.y+dir.y*speed;
  let wrapped=false;

  if(x<0){x+=canvas.width; wrapped=true;}
  if(y<0){y+=canvas.height; wrapped=true;}
  if(x>canvas.width){x-=canvas.width; wrapped=true;}
  if(y>canvas.height){y-=canvas.height; wrapped=true;}

  snake.unshift({x,y,wrap:wrapped});
  snake.pop();

  if(Math.hypot(x-food.x,y-food.y)<20){
    snake.push({...snake.at(-1)});
    spawnFood();
    foodCount++;
    playSFX(eatSound);
    if(foodCount%5===0) spawnBossFood();
  }

  if(bossFood){
    bossTimer--;
    if(Math.hypot(x-bossFood.x,y-bossFood.y)<25){
      for(let i=0;i<5;i++) snake.push({...snake.at(-1)});
      bossFood=null;
      playSFX(bossEatSound);
    }
    if(bossTimer<=0) bossFood=null;
  }
}

function drawSnake(){
  ctx.lineWidth=18;
  ctx.lineJoin=ctx.lineCap="round";
  ctx.strokeStyle=ctx.createLinearGradient(
    snake[0].x,snake[0].y,
    snake.at(-1).x,snake.at(-1).y
  );
  ctx.strokeStyle="#00ffd5";

  ctx.beginPath();
  ctx.moveTo(snake[0].x,snake[0].y);

  for(let i=1;i<snake.length;i++){
    if(snake[i].wrap){ ctx.stroke(); ctx.beginPath(); ctx.moveTo(snake[i].x,snake[i].y); }
    ctx.lineTo(snake[i].x,snake[i].y);
  }
  ctx.stroke();

  // HEAD
  const h=snake[0];
  ctx.fillStyle="#00ffe1";
  ctx.beginPath();
  ctx.arc(h.x,h.y,14,0,Math.PI*2);
  ctx.fill();

  // EYES
  const a=Math.atan2(dir.y,dir.x);
  for(let s of [-1,1]){
    ctx.fillStyle="#fff";
    ctx.beginPath();
    ctx.arc(h.x+Math.cos(a+0.4*s)*6,h.y+Math.sin(a+0.4*s)*6,3,0,Math.PI*2);
    ctx.fill();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="#ff4757";
  ctx.shadowBlur=15;
  ctx.shadowColor="#ff4757";
  ctx.beginPath();
  ctx.arc(food.x,food.y,8,0,Math.PI*2);
  ctx.fill();
  ctx.shadowBlur=0;

  if(bossFood){
    ctx.fillStyle="#ffd700";
    ctx.shadowBlur=20;
    ctx.shadowColor="#ffd700";
    ctx.beginPath();
    ctx.arc(bossFood.x,bossFood.y,14,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur=0;
    ctx.fillStyle="#fff";
    ctx.font="14px monospace";
    ctx.fillText(Math.ceil(bossTimer/60),bossFood.x-6,bossFood.y-20);
  }

  drawSnake();
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
